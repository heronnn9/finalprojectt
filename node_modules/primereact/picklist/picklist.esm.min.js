import*as e from"react";import t,{FilterService as n}from"primereact/api";import{useMatchMedia as r,useMountEffect as o,useUpdateEffect as l}from"primereact/hooks";import{ObjectUtils as i,classNames as a,IconUtils as c,DomHandler as u,UniqueComponentId as s}from"primereact/utils";import{Button as m}from"primereact/button";import{AngleDownIcon as p}from"primereact/icons/angledown";import{AngleDoubleUpIcon as v}from"primereact/icons/angledoubleup";import{AngleUpIcon as f}from"primereact/icons/angleup";import{AngleDoubleDownIcon as g}from"primereact/icons/angledoubledown";import{Ripple as d}from"primereact/ripple";import{SearchIcon as h}from"primereact/icons/search";import{AngleLeftIcon as T}from"primereact/icons/angleleft";import{AngleDoubleLeftIcon as y}from"primereact/icons/angledoubleleft";import{AngleDoubleRightIcon as I}from"primereact/icons/angledoubleright";import{AngleRightIcon as S}from"primereact/icons/angleright";function b(){return b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},b.apply(this,arguments)}function E(e){if(Array.isArray(e))return e}function k(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,l,i,a=[],c=!0,u=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=l.call(n)).done)&&(a.push(r.value),a.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return a}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function C(e,t){if(e){if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}function N(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function F(e,t){return E(e)||k(e,t)||C(e,t)||N()}var L={defaultProps:{__TYPE:"PickList",id:null,source:null,target:null,sourceHeader:null,targetHeader:null,style:null,className:null,sourceStyle:null,targetStyle:null,sourceSelection:null,targetSelection:null,showSourceControls:!0,showTargetControls:!0,metaKeySelection:!0,filter:!1,filterBy:null,filterMatchMode:"contains",targetFilterIcon:null,sourceFilterIcon:null,moveAllToSourceIcon:null,moveToSourceIcon:null,moveAllToTargetIcon:null,moveToTargetIcon:null,moveBottomIcon:null,moveUpIcon:null,moveTopIcon:null,moveDownIcon:null,filterLocale:void 0,sourceFilterValue:null,targetFilterValue:null,showSourceFilter:!0,showTargetFilter:!0,sourceFilterPlaceholder:null,targetFilterPlaceholder:null,sourceFilterTemplate:null,targetFilterTemplate:null,tabIndex:0,dataKey:null,breakpoint:"960px",itemTemplate:null,sourceItemTemplate:null,targetItemTemplate:null,onChange:null,onMoveToSource:null,onMoveAllToSource:null,onMoveToTarget:null,onMoveAllToTarget:null,onSourceSelectionChange:null,onTargetSelectionChange:null,onSourceFilterChange:null,onTargetFilterChange:null,children:void 0},getProps:function(e){return i.getMergedProps(e,L.defaultProps)},getOtherProps:function(e){return i.getDiffProps(e,L.defaultProps)}};function K(e){if(Array.isArray(e))return w(e)}function x(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function A(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function P(e){return K(e)||x(e)||C(e)||A()}var R=e.memo((function(t){var n=t.moveUpIcon||e.createElement(f,null),r=t.moveTopIcon||e.createElement(v,null),o=t.moveDownIcon||e.createElement(p,null),l=t.moveBottomIcon||e.createElement(g,null),c=!t.selection||!t.selection.length,u=a("p-picklist-buttons",t.className);return e.createElement("div",{className:u},e.createElement(m,{disabled:c,type:"button",icon:n,onClick:function(e){var n=t.selection;if(n&&n.length){for(var r=P(t.list),o=0;o<n.length;o++){var l=i.findIndexInList(n[o],r,t.dataKey);if(0===l)break;var a=r[l-1];r[l-1]=r[l],r[l]=a}t.onReorder&&t.onReorder({originalEvent:e,value:r,direction:"up"})}}}),e.createElement(m,{disabled:c,type:"button",icon:r,onClick:function(e){var n=t.selection;if(n&&n.length){for(var r=P(t.list),o=0;o<n.length;o++){var l=i.findIndexInList(n[o],r,t.dataKey);if(0===l)break;var a=r.splice(l,1)[0];r.unshift(a)}t.onReorder&&t.onReorder({originalEvent:e,value:r,direction:"top"})}}}),e.createElement(m,{disabled:c,type:"button",icon:o,onClick:function(e){var n=t.selection;if(n&&n.length){for(var r=P(t.list),o=n.length-1;o>=0;o--){var l=i.findIndexInList(n[o],r,t.dataKey);if(l===r.length-1)break;var a=r[l+1];r[l+1]=r[l],r[l]=a}t.onReorder&&t.onReorder({originalEvent:e,value:r,direction:"down"})}}}),e.createElement(m,{disabled:c,type:"button",icon:l,onClick:function(e){var n=t.selection;if(n&&n.length){for(var r=P(t.list),o=n.length-1;o>=0;o--){var l=i.findIndexInList(n[o],r,t.dataKey);if(l===r.length-1)break;var a=r.splice(l,1)[0];r.push(a)}t.onReorder&&t.onReorder({originalEvent:e,value:r,direction:"bottom"})}}}))}));R.displayName="PickListControls";var M=e.memo((function(t){var n=t.template?t.template(t.value):t.value,r=a("p-picklist-item",{"p-highlight":t.selected},t.className);return e.createElement("li",{className:r,onClick:function(e){t.onClick&&t.onClick({originalEvent:e,value:t.value})},onKeyDown:function(e){t.onKeyDown&&t.onKeyDown({originalEvent:e,value:t.value})},tabIndex:t.tabIndex,role:"option","aria-selected":t.selected},n,e.createElement(d,null))}));M.displayName="PickListItem";var D=e.memo(e.forwardRef((function(t,n){var r=e.useRef(null),o=function(e){var n=e.originalEvent,r=e.value,o=P(t.selection),l=i.findIndexInList(r,o,t.dataKey),a=-1!==l;if(t.metaKeySelection){var c=n.metaKey||n.ctrlKey;a&&c?o.splice(l,1):(c||(o.length=0),o.push(r))}else a?o.splice(l,1):o.push(r);t.onSelectionChange&&t.onSelectionChange({event:n,value:o})},l=function(e){var t=e.originalEvent,n=t.currentTarget;switch(t.which){case 40:var r=s(n);r&&r.focus(),t.preventDefault();break;case 38:var l=m(n);l&&l.focus(),t.preventDefault();break;case 13:o(e),t.preventDefault()}},s=function e(t){var n=t.nextElementSibling;return n?u.hasClass(n,"p-picklist-item")?n:e(n):null},m=function e(t){var n=t.previousElementSibling;return n?u.hasClass(n,"p-picklist-item")?n:e(n):null},p=function(e){return-1!==i.findIndexInList(e,t.selection,t.dataKey)},v=function(e){t.onFilter&&t.onFilter({originalEvent:e,value:e.target.value,type:t.type})},f=function(e){13===e.which&&e.preventDefault()};e.useImperativeHandle(n,(function(){return{listElementRef:r}}));var g=a("p-picklist-list-wrapper",t.className),d=t.header?e.createElement("div",{className:"p-picklist-header"},i.getJSXElement(t.header,t)):null,T=function(){var n="p-picklist-filter-icon",r=c.getJSXIcon("source"===t.type?t.sourceFilterIcon||e.createElement(h,{className:n}):t.targetFilterIcon||e.createElement(h,{className:n}),{className:n},{props:t});if(t.showFilter){var o=e.createElement("div",{className:"p-picklist-filter"},e.createElement("input",{type:"text",value:t.filterValue,onChange:v,onKeyDown:f,placeholder:t.placeholder,className:"p-picklist-filter-input p-inputtext p-component"}),e.createElement("span",null," ",r," "));if(t.filterTemplate)o=i.getJSXElement(t.filterTemplate,{className:"p-picklist-filter",inputProps:{className:"p-picklist-filter-input p-inputtext p-component",onChange:v,onKeyDown:f},iconClassName:n,element:o,props:t});return e.createElement("div",{className:"p-picklist-filter-container"},o)}return null}(),y=function(){var n=t.list?t.list.map((function(n){var r=JSON.stringify(n),i=p(n);return e.createElement(M,{key:r,value:n,template:t.itemTemplate,selected:i,onClick:o,onKeyDown:l,tabIndex:t.tabIndex})})):null,r=a("p-picklist-list",t.listClassName);return e.createElement("ul",{className:r,style:t.style,role:"listbox","aria-multiselectable":!0},n)}();return e.createElement("div",{ref:r,className:g},d,T,y)})));D.displayName="PickListSubList";var O=e.memo((function(t){var n=r("(max-width: ".concat(t.breakpoint,")"),t.breakpoint);function o(r){switch(r){case"moveToTargetIcon":return e.createElement(t.moveToTargetIcon||n?p:S,null);case"moveAllToTargetIcon":return e.createElement(t.moveAllToTargetIcon||n?g:I,null);case"moveToSourceIcon":return e.createElement(t.moveToSourceIcon||n?f:T,null);case"moveAllToSourceIcon":return e.createElement(t.moveAllToSourceIcon||n?v:y,null);default:return null}}var l=c.getJSXIcon(o("moveToTargetIcon"),void 0,{props:t,viewChanged:n}),u=c.getJSXIcon(o("moveAllToTargetIcon"),void 0,{props:t,viewChanged:n}),s=c.getJSXIcon(o("moveToSourceIcon"),void 0,{props:t,viewChanged:n}),d=c.getJSXIcon(o("moveAllToSourceIcon"),void 0,{props:t,viewChanged:n}),h=i.isEmpty(t.sourceSelection)||i.isEmpty(t.visibleSourceList),b=i.isEmpty(t.targetSelection)||i.isEmpty(t.visibleTargetList),E=i.isEmpty(t.visibleSourceList),k=i.isEmpty(t.visibleTargetList),w=a("p-picklist-buttons p-picklist-transfer-buttons",t.className);return e.createElement("div",{className:w},e.createElement(m,{disabled:h,type:"button",icon:l,onClick:function(e){var n=t.sourceSelection;if(i.isNotEmpty(n)){for(var r=P(t.target),o=P(t.source),l=0;l<n.length;l++){var a=n[l];-1===i.findIndexInList(a,r,t.dataKey)&&r.push(o.splice(i.findIndexInList(a,o,t.dataKey),1)[0])}t.onTransfer&&t.onTransfer({originalEvent:e,source:o,target:r,direction:"toTarget"})}}}),e.createElement(m,{disabled:E,type:"button",icon:u,onClick:function(e){if(t.source){var n=[].concat(P(t.target),P(t.visibleSourceList)),r=t.source.filter((function(e){return!t.visibleSourceList.some((function(t){return t===e}))}));t.onTransfer&&t.onTransfer({originalEvent:e,source:r,target:n,direction:"allToTarget"})}}}),e.createElement(m,{disabled:b,type:"button",icon:s,onClick:function(e){var n=t.targetSelection;if(i.isNotEmpty(n)){for(var r=P(t.target),o=P(t.source),l=0;l<n.length;l++){var a=n[l];-1===i.findIndexInList(a,o,t.dataKey)&&o.push(r.splice(i.findIndexInList(a,r,t.dataKey),1)[0])}t.onTransfer&&t.onTransfer({originalEvent:e,source:o,target:r,direction:"toSource"})}}}),e.createElement(m,{disabled:k,type:"button",icon:d,onClick:function(e){if(t.source){var n=[].concat(P(t.source),P(t.visibleTargetList)),r=t.target.filter((function(e){return!t.visibleTargetList.some((function(t){return t===e}))}));t.onTransfer&&t.onTransfer({originalEvent:e,source:n,target:r,direction:"allToSource"})}}}))}));O.displayName="PickListTransferControls";var B=e.memo(e.forwardRef((function(r,c){var m=L.getProps(r),p=F(e.useState([]),2),v=p[0],f=p[1],g=F(e.useState([]),2),d=g[0],h=g[1],T=F(e.useState(""),2),y=T[0],I=T[1],S=F(e.useState(""),2),E=S[0],k=S[1],w=F(e.useState(null),2),C=w[0],N=w[1],K=e.useRef(null),x=e.useRef(null),A=e.useRef(null),P=e.useRef(null),M=e.useRef(null),B=e.useRef(null),j=m.sourceSelection?m.sourceSelection:v,H=m.targetSelection?m.targetSelection:d,J=m.onSourceFilterChange?m.sourceFilterValue:y,V=m.onTargetFilterChange?m.targetFilterValue:E,U=i.isNotEmpty(m.filterBy),X=U&&m.showSourceFilter,_=U&&m.showTargetFilter,Y=function(e,t){if(e){var n=u.findSingle(e,".p-picklist-list");switch(t){case"up":q(n,-1);break;case"top":n.scrollTop=0;break;case"down":q(n,1);break;case"bottom":setTimeout((function(){return n.scrollTop=n.scrollHeight}),100)}}},$=function(e,t,n){m.onChange&&m.onChange({originalEvent:e.originalEvent,source:t,target:n})},q=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=e.getElementsByClassName("p-highlight");i.isNotEmpty(n)&&u.scrollInView(e,-1===t?n[0]:n[n.length-1])},z=function(e,t,n){"sourceSelection"===t?f(e.value):h(e.value),n&&n(e),i.isNotEmpty(j)&&"targetSelection"===t?f([]):i.isNotEmpty(H)&&"sourceSelection"===t&&h([])},G=function(e){var t=e.originalEvent,n=e.value,r=F("source"===e.type?[I,m.onSourceFilterChange]:[k,m.onTargetFilterChange],2),o=r[0],l=r[1];l?l({originalEvent:t,value:n}):o(n)},Q=function(e,t){var n=F("source"===t?[J,W]:[V,Z],2),r=n[0],o=n[1];return U&&i.isNotEmpty(r)?o(r):e},W=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").trim().toLocaleLowerCase(m.filterLocale);return ee(m.source,e)},Z=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").trim().toLocaleLowerCase(m.filterLocale);return ee(m.target,e)},ee=function(e,t){var r=U?m.filterBy.split(","):[];return n.filter(e,r,t,m.filterMatchMode,m.filterLocale)},te=function(){if(!B.current){B.current=u.createInlineStyle(t.nonce);var e="\n@media screen and (max-width: ".concat(m.breakpoint,") {\n    .p-picklist[").concat(C,"] {\n        flex-direction: column;\n    }\n\n    .p-picklist[").concat(C,"] .p-picklist-buttons {\n        padding: var(--content-padding);\n        flex-direction: row;\n    }\n\n    .p-picklist[").concat(C,"] .p-picklist-buttons .p-button {\n        margin-right: var(--inline-spacing);\n        margin-bottom: 0;\n    }\n\n    .p-picklist[").concat(C,"] .p-picklist-buttons .p-button:last-child {\n        margin-right: 0;\n    }\n}\n");B.current.innerHTML=e}};e.useImperativeHandle(c,(function(){return{props:m,getElement:function(){return K.current}}})),o((function(){!C&&N(s())})),l((function(){return C&&(K.current.setAttribute(C,""),te()),function(){B.current=u.removeInlineStyle(B.current)}}),[C,m.breakpoint]),l((function(){P.current&&(Y(P.current,M.current),P.current=null,M.current=null)}));var ne=L.getOtherProps(m),re=a("p-picklist p-component",m.className),oe=m.sourceItemTemplate?m.sourceItemTemplate:m.itemTemplate,le=m.targetItemTemplate?m.targetItemTemplate:m.itemTemplate,ie=Q(m.source,"source"),ae=Q(m.target,"target");return e.createElement("div",b({id:m.id,ref:K,className:re,style:m.style},ne),m.showSourceControls&&e.createElement(R,{list:m.source,selection:j,onReorder:function(e){$(e,e.value,m.target),P.current=x.current.listElementRef.current,M.current=e.direction},className:"p-picklist-source-controls",dataKey:m.dataKey,moveUpIcon:m.moveUpIcon,moveTopIcon:m.moveTopIcon,moveDownIcon:m.moveDownIcon,moveBottomIcon:m.moveBottomIcon}),e.createElement(D,{ref:x,type:"source",list:ie,selection:j,onSelectionChange:function(e){return z(e,"sourceSelection",m.onSourceSelectionChange)},itemTemplate:oe,header:m.sourceHeader,style:m.sourceStyle,className:"p-picklist-source-wrapper",listClassName:"p-picklist-source",metaKeySelection:m.metaKeySelection,tabIndex:m.tabIndex,dataKey:m.dataKey,filterValue:J,onFilter:G,showFilter:X,placeholder:m.sourceFilterPlaceholder,template:m.sourceFilterTemplate,sourceFilterIcon:m.sourceFilterIcon}),e.createElement(O,{onTransfer:function(e){var t=e.originalEvent,n=e.source,r=e.target,o=[];switch(e.direction){case"toTarget":o=j,m.onMoveToTarget&&m.onMoveToTarget({originalEvent:t,value:o});break;case"allToTarget":o=m.source,m.onMoveAllToTarget&&m.onMoveAllToTarget({originalEvent:t,value:o});break;case"toSource":o=H,m.onMoveToSource&&m.onMoveToSource({originalEvent:t,value:o});break;case"allToSource":o=m.target,m.onMoveAllToSource&&m.onMoveAllToSource({originalEvent:t,value:o})}z({originalEvent:t,value:o},"sourceSelection",m.onSourceSelectionChange),z({originalEvent:t,value:o},"targetSelection",m.onTargetSelectionChange),$(e,n,r)},source:m.source,visibleSourceList:ie,target:m.target,breakpoint:m.breakpoint,visibleTargetList:ae,sourceSelection:j,targetSelection:H,dataKey:m.dataKey,moveToTargetIcon:m.moveToTargetIcon,moveAllToTargetIcon:m.moveAllToTargetIcon,moveToSourceIcon:m.moveToSourceIcon,moveAllToSourceIcon:m.moveAllToSourceIcon}),e.createElement(D,{ref:A,type:"target",list:ae,selection:H,onSelectionChange:function(e){return z(e,"targetSelection",m.onTargetSelectionChange)},itemTemplate:le,header:m.targetHeader,style:m.targetStyle,className:"p-picklist-target-wrapper",listClassName:"p-picklist-target",metaKeySelection:m.metaKeySelection,tabIndex:m.tabIndex,dataKey:m.dataKey,filterValue:V,onFilter:G,showFilter:_,placeholder:m.targetFilterPlaceholder,template:m.targetFilterTemplate,targetFilterIcon:m.targetFilterIcon}),m.showTargetControls&&e.createElement(R,{list:m.target,selection:H,onReorder:function(e){$(e,m.source,e.value),P.current=A.current.listElementRef.current,M.current=e.direction},className:"p-picklist-target-controls",dataKey:m.dataKey,moveUpIcon:m.moveUpIcon,moveTopIcon:m.moveTopIcon,moveDownIcon:m.moveDownIcon,moveBottomIcon:m.moveBottomIcon}))})));B.displayName="PickList";export{B as PickList};
