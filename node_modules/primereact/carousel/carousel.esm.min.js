import*as e from"react";import t,{ariaLabel as n}from"primereact/api";import{usePrevious as r,useResizeListener as a,useMountEffect as l,useUpdateEffect as o,useUnmountEffect as c}from"primereact/hooks";import{Ripple as u}from"primereact/ripple";import{ObjectUtils as i,classNames as s,UniqueComponentId as m,DomHandler as p,IconUtils as f}from"primereact/utils";import{ChevronUpIcon as v}from"primereact/icons/chevronup";import{ChevronRightIcon as d}from"primereact/icons/chevronright";import{ChevronDownIcon as h}from"primereact/icons/chevrondown";import{ChevronLeftIcon as g}from"primereact/icons/chevronleft";function b(){return b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},b.apply(this,arguments)}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function N(e){if(Array.isArray(e))return y(e)}function E(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function I(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}function S(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function C(e){if(Array.isArray(e))return e}function P(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,l,o,c=[],u=!0,i=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=l.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){i=!0,a=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(i)throw a}}return c}}function w(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function k(e,t){return C(e)||P(e,t)||I(e,t)||w()}var x={defaultProps:{__TYPE:"Carousel",id:null,value:null,page:0,header:null,footer:null,style:null,className:null,itemTemplate:null,circular:!1,showIndicators:!0,showNavigators:!0,autoplayInterval:0,numVisible:1,numScroll:1,prevIcon:null,nextIcon:null,responsiveOptions:null,orientation:"horizontal",verticalViewPortHeight:"300px",contentClassName:null,containerClassName:null,indicatorsContentClassName:null,onPageChange:null,children:void 0},getProps:function(e){return i.getMergedProps(e,x.defaultProps)},getOtherProps:function(e){return i.getDiffProps(e,x.defaultProps)}},O=e.memo((function(t){var n=t.template(t.item),r=s(t.className,"p-carousel-item",{"p-carousel-item-active":t.active,"p-carousel-item-start":t.start,"p-carousel-item-end":t.end});return e.createElement("div",{className:r},n)})),T=e.memo(e.forwardRef((function(y,C){var P=x.getProps(y),w=k(e.useState(P.numVisible),2),T=w[0],R=w[1],A=k(e.useState(P.numScroll),2),M=A[0],V=A[1],j=k(e.useState(P.page*P.numScroll*-1),2),D=j[0],H=j[1],L=k(e.useState(P.page),2),X=L[0],_=L[1],Y=e.useRef(null),z=e.useRef(null),J=e.useRef(0),F=e.useRef(!!P.autoplayInterval),U=e.useRef(""),W=e.useRef(20),$=e.useRef(null),q=e.useRef(null),B=e.useRef(null),G=e.useRef(!1),K=e.useRef(null),Q=r(M),Z=r(T),ee=r(P.value),te=r(P.page),ne="vertical"===P.orientation,re=P.circular||!!P.autoplayInterval,ae=re&&P.value&&P.value.length>=T,le=P.onPageChange?P.page:X,oe=P.value?Math.max(Math.ceil((P.value.length-T)/M)+1,0):0,ce=oe&&P.autoplayInterval&&F.current,ue=k(a({listener:function(){se()},when:P.responsiveOptions}),1)[0],ie=function(e,t){var n=D;null!=t?(n=M*t*-1,ae&&(n-=T),G.current=!1):(n+=M*e,G.current&&(n+=J.current-M*e,G.current=!1),t=Math.abs(Math.floor((ae?n+T:n)/M)));ae&&X===oe-1&&-1===e?(n=-1*(P.value.length+T),t=0):ae&&0===X&&1===e?(n=0,t=oe-1):t===oe-1&&J.current>0&&(n+=-1*J.current-M*e,G.current=!0),z.current&&(p.removeClass(z.current,"p-items-hidden"),Ee(n),z.current.style.transition="transform 500ms ease 0s"),P.onPageChange?(H(n),P.onPageChange({page:t})):(_(t),H(n))},se=function(){if(z.current&&K.current){for(var e=window.innerWidth,t={numVisible:P.numVisible,numScroll:P.numScroll},n=0;n<K.current.length;n++){var r=K.current[n];parseInt(r.breakpoint,10)>=e&&(t=r)}if(M!==t.numScroll){var a=Math.floor(le*M/t.numScroll),l=t.numScroll*a*-1;ae&&(l-=t.numVisible),H(l),V(t.numScroll),P.onPageChange?P.onPageChange({page:a}):_(a)}T!==t.numVisible&&R(t.numVisible)}},me=function(e,t){(re||0!==le)&&ie(1,t),F.current=!1,e.cancelable&&e.preventDefault()},pe=function(e,t){(re||le<oe-1)&&ie(-1,t),F.current=!1,e.cancelable&&e.preventDefault()},fe=function(e,t){t>le?pe(e,t):t<le&&me(e,t)},ve=function(e){z.current&&"transform"===e.propertyName&&(p.addClass(z.current,"p-items-hidden"),z.current.style.transition="",0!==X&&X!==oe-1||!ae||Ee(D))},de=function(e){var t=e.changedTouches[0];$.current={x:t.pageX,y:t.pageY}},he=function(e){e.cancelable&&e.preventDefault()},ge=function(e){var t=e.changedTouches[0];be(e,ne?t.pageY-$.current.y:t.pageX-$.current.x)},be=function(e,t){Math.abs(t)>W&&(t<0?pe(e):me(e))},ye=function(){q.current&&clearInterval(q.current)},Ne=function(){B.current||(B.current=p.createInlineStyle(t.nonce));var e,n="\n            .p-carousel[".concat(U.current,"] .p-carousel-item {\n                flex: 1 0 ").concat(100/T,"%\n            }\n        ");if(P.responsiveOptions){K.current=N(e=P.responsiveOptions)||E(e)||I(e)||S(),K.current.sort((function(e,n){return i.sort(e.breakpoint,n.breakpoint,-1,t.locale,t.nullSortOrder)}));for(var r=0;r<K.current.length;r++){var a=K.current[r];n+="\n                    @media screen and (max-width: ".concat(a.breakpoint,") {\n                        .p-carousel[").concat(U.current,"] .p-carousel-item {\n                            flex: 1 0 ").concat(100/a.numVisible,"%\n                        }\n                    }\n                ")}}B.current.innerHTML=n},Ee=function(e){z.current&&(z.current.style.transform=ne?"translate3d(0, ".concat(e*(100/T),"%, 0)"):"translate3d(".concat(e*(100/T),"%, 0, 0)"))};e.useImperativeHandle(C,(function(){return{props:P,getElement:function(){return Y.current}}})),l((function(){Y.current&&(U.current=m(),Y.current.setAttribute(U.current,"")),Ne(),se(),Ee(D),ue()})),o((function(){var e=!1,t=D;if(P.autoplayInterval&&ye(),Q!==M||Z!==T||P.value&&ee&&ee.length!==P.value.length){J.current=(P.value.length-T)%M;var n=le;0!==oe&&n>=oe&&(n=oe-1,P.onPageChange?P.onPageChange({page:n}):_(n),e=!0),t=n*M*-1,ae&&(t-=T),n===oe-1&&J.current>0?(t+=-1*J.current+M,G.current=!0):G.current=!1,t!==D&&(H(t),e=!0),Ee(t)}ae&&(0===X?t=-1*T:0===t&&(t=-1*P.value.length,J.current>0&&(G.current=!0)),t!==D&&(H(t),e=!0)),te!==P.page&&(P.page>te&&P.page<=oe-1?ie(-1,P.page):P.page<te&&ie(1,P.page)),!e&&ce&&(q.current=setInterval((function(){ie(-1,X===oe-1?0:X+1)}),P.autoplayInterval))})),c((function(){P.autoplayInterval&&ye()}));var Ie=function(){if(P.value&&P.value.length){var t=null,n=null;if(ae){var r=null;t=(r=P.value.slice(-1*T)).map((function(t,n){return e.createElement(O,{key:n+"_scloned",className:"p-carousel-item-cloned",template:P.itemTemplate,item:t,active:-1*D===P.value.length+T,start:0===n,end:n===r.length-1})})),n=(r=P.value.slice(0,T)).map((function(t,n){return e.createElement(O,{key:n+"_fcloned",className:"p-carousel-item-cloned",template:P.itemTemplate,item:t,active:0===D,start:0===n,end:n===r.length-1})}))}var a=P.value.map((function(t,n){var r=ae?-1*(D+T):-1*D,a=r+T-1;return e.createElement(O,{key:n,template:P.itemTemplate,item:t,active:r<=n&&a>=n,start:r===n,end:a===n})}));return e.createElement(e.Fragment,null,t,a,n)}},Se=function(){if(P.showNavigators){var t=(!re||P.value&&P.value.length<T)&&0===le,r=s("p-carousel-prev p-link",{"p-disabled":t}),a="p-carousel-prev-icon",l=f.getJSXIcon(ne?P.prevIcon||e.createElement(v,{className:a}):P.prevIcon||e.createElement(g,{className:a}),{className:r},{props:P});return e.createElement("button",{type:"button",className:r,onClick:me,disabled:t,"aria-label":n("previousPageLabel")},l,e.createElement(u,null))}return null},Ce=function(){if(P.showNavigators){var t=(!re||P.value&&P.value.length<T)&&(le===oe-1||0===oe),r=s("p-carousel-next p-link",{"p-disabled":t}),a="p-carousel-next-icon",l=f.getJSXIcon(ne?P.nextIcon||e.createElement(h,{className:a}):P.nextIcon||e.createElement(d,{className:a}),{className:r},{props:P});return e.createElement("button",{type:"button",className:r,onClick:pe,disabled:t,"aria-label":n("nextPageLabel")},l,e.createElement(u,null))}return null},Pe=function(t){var r="carousel-indicator-"+t,a=s("p-carousel-indicator",{"p-highlight":le===t});return e.createElement("li",{key:r,className:a},e.createElement("button",{type:"button",className:"p-link",onClick:function(e){return fe(e,t)},"aria-label":"".concat(n("pageLabel")," ").concat(t+1)},e.createElement(u,null)))},we=x.getOtherProps(P),ke=s("p-carousel p-component",{"p-carousel-vertical":ne,"p-carousel-horizontal":!ne},P.className),xe=s("p-carousel-content",P.contentClassName),Oe=function(){var t=Ie(),n=ne?P.verticalViewPortHeight:"auto",r=Se(),a=Ce(),l=s("p-carousel-container",P.containerClassName);return e.createElement("div",{className:l},r,e.createElement("div",{className:"p-carousel-items-content",style:{height:n},onTouchStart:de,onTouchMove:he,onTouchEnd:ge},e.createElement("div",{ref:z,className:"p-carousel-items-container",onTransitionEnd:ve},t)),a)}(),Te=function(){if(P.showIndicators){for(var t=s("p-carousel-indicators p-reset",P.indicatorsContentClassName),n=[],r=0;r<oe;r++)n.push(Pe(r));return e.createElement("ul",{className:t},n)}return null}(),Re=P.header?e.createElement("div",{className:"p-carousel-header"},P.header):null,Ae=P.footer?e.createElement("div",{className:"p-carousel-footer"},P.footer):null;return e.createElement("div",b({ref:Y,id:P.id,className:ke,style:P.style},we),Re,e.createElement("div",{className:xe},Oe,Te),Ae)})));O.displayName="CarouselItem",T.displayName="Carousel";export{T as Carousel};
