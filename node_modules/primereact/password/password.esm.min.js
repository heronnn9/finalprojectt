import*as e from"react";import t,{localeOption as n}from"primereact/api";import{CSSTransition as r}from"primereact/csstransition";import{useOverlayListener as o,useUnmountEffect as l}from"primereact/hooks";import{InputText as a}from"primereact/inputtext";import{OverlayService as i}from"primereact/overlayservice";import{Portal as u}from"primereact/portal";import{ObjectUtils as s,DomHandler as c,ZIndexUtils as p,classNames as f,IconUtils as m}from"primereact/utils";import{EyeIcon as d}from"primereact/icons/eye";import{EyeSlashIcon as g}from"primereact/icons/eyeslash";function h(){return h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h.apply(this,arguments)}function y(e){if(Array.isArray(e))return e}function w(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,l,a,i=[],u=!0,s=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=l.call(n)).done)&&(i.push(r.value),i.length!==t);u=!0);}catch(e){s=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return i}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function E(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}function b(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function k(e,t){return y(e)||w(e,t)||E(e,t)||b()}var R={defaultProps:{__TYPE:"Password",id:null,inputId:null,inputRef:null,promptLabel:null,weakLabel:null,mediumLabel:null,strongLabel:null,mediumRegex:"^(((?=.*[a-z])(?=.*[A-Z]))|((?=.*[a-z])(?=.*[0-9]))|((?=.*[A-Z])(?=.*[0-9])))(?=.{6,})",strongRegex:"^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.{8,})",feedback:!0,toggleMask:!1,appendTo:null,header:null,content:null,footer:null,showIcon:null,hideIcon:null,icon:null,tooltip:null,tooltipOptions:null,style:null,className:null,inputStyle:null,inputClassName:null,panelStyle:null,panelClassName:null,transitionOptions:null,onInput:null,onShow:null,onHide:null,children:void 0},getProps:function(e){return s.getMergedProps(e,R.defaultProps)},getOtherProps:function(e){return s.getDiffProps(e,R.defaultProps)}},S=e.memo(e.forwardRef((function(y,w){var v=R.getProps(y),E=v.promptLabel||n("passwordPrompt"),b=v.weakLabel||n("weak"),S=v.mediumLabel||n("medium"),I=v.strongLabel||n("strong"),x=k(e.useState(!1),2),N=x[0],O=x[1],C=k(e.useState(null),2),P=C[0],A=C[1],j=k(e.useState(E),2),L=j[0],T=j[1],J=k(e.useState(!1),2),M=J[0],X=J[1],z=k(e.useState(!1),2),F=z[0],H=z[1],U=e.useRef(null),Z=e.useRef(null),B=e.useRef(v.inputRef),K=e.useRef(new RegExp(v.mediumRegex)),V=e.useRef(new RegExp(v.strongRegex)),_=F?"text":"password",D=k(o({target:U,overlay:Z,listener:function(e,t){t.valid&&ne()},when:N}),2),Y=D[0],$=D[1],q=B.current&&B.current.value,G=e.useMemo((function(){return s.isNotEmpty(v.value)||s.isNotEmpty(v.defaultValue)||s.isNotEmpty(q)}),[v.value,v.defaultValue,q]),Q=function(){if(P){var e=null;switch(P.strength){case"weak":e=b;break;case"medium":e=S;break;case"strong":e=I}e&&L!==e&&T(e)}else L!==E&&T(E)},W=function(e){v.feedback&&i.emit("overlay-click",{originalEvent:e,target:U.current})},ee=function(){H((function(e){return!e}))},te=function(){Q(),O(!0)},ne=function(){O(!1)},re=function(){p.set("overlay",Z.current,t.autoZIndex,t.zIndex.overlay),B.current&&c.alignOverlay(Z.current,B.current.parentElement,v.appendTo||t.appendTo)},oe=function(){Y(),v.onShow&&v.onShow()},le=function(){$()},ae=function(){p.clear(Z.current),v.onHide&&v.onHide()},ie=function(e){return V.current.test(e)?3:K.current.test(e)?2:e.length?1:0};e.useImperativeHandle(w,(function(){return{props:v,focus:function(){return c.focus(B.current)},getElement:function(){return U.current},getOverlay:function(){return Z.current},getInput:function(){return B.current}}})),e.useEffect((function(){s.combinedRefs(B,v.inputRef)}),[B,v.inputRef]),e.useEffect((function(){K.current=new RegExp(v.mediumRegex)}),[v.mediumRegex]),e.useEffect((function(){V.current=new RegExp(v.strongRegex)}),[v.strongRegex]),e.useEffect((function(){!G&&c.hasClass(U.current,"p-inputwrapper-filled")&&c.removeClass(U.current,"p-inputwrapper-filled")}),[G]),l((function(){p.clear(Z.current)}));var ue,se,ce,pe,fe,me,de,ge=f("p-password p-component p-inputwrapper",{"p-inputwrapper-filled":G,"p-inputwrapper-focus":M,"p-input-icon-right":v.toggleMask},v.className),he=f("p-password-input",v.inputClassName),ye=R.getOtherProps(v),we=function(){var t,n=m.getJSXIcon(t=F?v.hideIcon||e.createElement(g,null):v.showIcon||e.createElement(d,null),void 0,{props:v}),r=m.getJSXIcon(t,void 0,{props:v});if(v.toggleMask){var o=e.createElement("i",{onClick:ee}," ",n||r," ");if(v.icon)o=s.getJSXElement(v.icon,{onClick:ee,className:ge,element:o,props:v});return o}return null}(),ve=(ue=f("p-password-panel p-component",v.panelClassName,{"p-input-filled":"filled"===t.inputStyle,"p-ripple-disabled":!1===t.ripple}),ce=(se=P||{strength:"",width:"0%"}).strength,pe=se.width,fe=s.getJSXElement(v.header,v),me=s.getJSXElement(v.footer,v),de=v.content?s.getJSXElement(v.content,v):e.createElement(e.Fragment,null,e.createElement("div",{className:"p-password-meter"},e.createElement("div",{className:"p-password-strength ".concat(ce),style:{width:pe}})),e.createElement("div",{className:"p-password-info ".concat(ce)},L)),e.createElement(u,{element:e.createElement(r,{nodeRef:Z,classNames:"p-connected-overlay",in:N,timeout:{enter:120,exit:100},options:v.transitionOptions,unmountOnExit:!0,onEnter:re,onEntered:oe,onExit:le,onExited:ae},e.createElement("div",{ref:Z,className:ue,style:v.panelStyle,onClick:W},fe,de,me)),appendTo:v.appendTo}));return e.createElement("div",{ref:U,id:v.id,className:ge,style:v.style},e.createElement(a,h({ref:B,id:v.inputId},ye,{type:_,className:he,style:v.inputStyle,onFocus:function(e){X(!0),v.feedback&&te(),v.onFocus&&v.onFocus(e)},onBlur:function(e){X(!1),v.feedback&&ne(),v.onBlur&&v.onBlur(e)},onKeyUp:function(e){var t=e.keyCode||e.which;if(v.feedback){var n=null,r=null;switch(ie(e.target.value)){case 1:n=b,r={strength:"weak",width:"33.33%"};break;case 2:n=S,r={strength:"medium",width:"66.66%"};break;case 3:n=I,r={strength:"strong",width:"100%"};break;default:n=E,r=null}A(r),T(n),t&&!N&&te()}v.onKeyUp&&v.onKeyUp(e)},onInput:function(e,t){v.onInput&&v.onInput(e,t),v.onChange||(s.isNotEmpty(e.target.value)?c.addClass(U.current,"p-inputwrapper-filled"):c.removeClass(U.current,"p-inputwrapper-filled"))},tooltip:v.tooltip,tooltipOptions:v.tooltipOptions,hideIcon:v.hideIcon,showIcon:v.showIcon})),we,ve)})));S.displayName="Password";export{S as Password};
