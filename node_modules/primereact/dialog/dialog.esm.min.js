import*as e from"react";import t,{localeOption as n}from"primereact/api";import{CSSTransition as r}from"primereact/csstransition";import{useEventListener as o,useMountEffect as i,useUpdateEffect as a,useUnmountEffect as l}from"primereact/hooks";import{Portal as c}from"primereact/portal";import{Ripple as u}from"primereact/ripple";import{ObjectUtils as s,UniqueComponentId as m,DomHandler as d,ZIndexUtils as p,classNames as f,IconUtils as g}from"primereact/utils";import{TimesIcon as b}from"primereact/icons/times";import{WindowMaximizeIcon as y}from"primereact/icons/windowmaximize";import{WindowMinimizeIcon as h}from"primereact/icons/windowminimize";function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},v.apply(this,arguments)}function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function S(e,t){if("object"!==w(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function E(e){var t=S(e,"string");return"symbol"===w(t)?t:String(t)}function x(e,t,n){return(t=E(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function z(e){if(Array.isArray(e))return k(e)}function O(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function C(e,t){if(e){if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}function P(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function D(e){if(Array.isArray(e))return e}function I(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function N(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function R(e,t){return D(e)||I(e,t)||C(e,t)||N()}var j={defaultProps:{__TYPE:"Dialog",appendTo:null,ariaCloseIconLabel:null,baseZIndex:0,blockScroll:!1,breakpoints:null,className:null,closable:!0,closeIcon:null,closeOnEscape:!0,contentClassName:null,contentStyle:null,dismissableMask:!1,draggable:!0,focusOnShow:!0,footer:null,header:null,headerClassName:null,headerStyle:null,icons:null,id:null,keepInViewport:!0,maskClassName:null,maskStyle:null,maximizable:!1,maximized:!1,minX:0,minY:0,modal:!0,onClick:null,onDrag:null,onDragEnd:null,onDragStart:null,onHide:null,onMaskClick:null,onMaximize:null,onResize:null,onResizeEnd:null,onResizeStart:null,onShow:null,position:"center",resizable:!0,rtl:!1,showHeader:!0,style:null,transitionOptions:null,visible:!1,maximizeIcon:null,minimizeIcon:null,children:void 0},getProps:function(e){return s.getMergedProps(e,j.defaultProps)},getOtherProps:function(e){return s.getDiffProps(e,j.defaultProps)}};function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var H=e.forwardRef((function(w,S){var E=j.getProps(w),x=E.id?E.id:m(),k=R(e.useState(x),2),D=k[0],I=R(e.useState(!1),2),N=I[0],M=I[1],H=R(e.useState(!1),2),A=H[0],T=H[1],Y=R(e.useState(E.maximized),2),B=Y[0],_=Y[1],J=e.useRef(null),V=e.useRef(null),L=e.useRef(null),W=e.useRef(null),Z=e.useRef(null),F=e.useRef(null),$=e.useRef(!1),K=e.useRef(!1),U=e.useRef(null),q=e.useRef(null),G=e.useRef(null),Q=e.useRef(x),ee=E.onMaximize?E.maximized:B,te=R(o({type:"keydown",listener:function(e){return ve(e)}}),2),ne=te[0],re=te[1],oe=R(o({type:"mousemove",target:function(){return window.document},listener:function(e){return ze(e)}}),2),ie=oe[0],ae=oe[1],le=R(o({type:"mouseup",target:function(){return window.document},listener:function(e){return Oe(e)}}),2),ce=le[0],ue=le[1],se=R(o({type:"mousemove",target:function(){return window.document},listener:function(e){return Se(e)}}),2),me=se[0],de=se[1],pe=R(o({type:"mouseup",target:function(){return window.document},listener:function(e){return Ee(e)}}),2),fe=pe[0],ge=pe[1],be=function(e){E.onHide(),e.preventDefault()},ye=function(e){E.dismissableMask&&E.modal&&V.current===e.target&&be(e),E.onMaskClick&&E.onMaskClick(e)},he=function(e){E.onMaximize?E.onMaximize({originalEvent:e,maximized:!ee}):_((function(e){return!e})),e.preventDefault()},ve=function(e){var t=e.currentTarget;if(t&&t.primeDialogParams){var n=t.primeDialogParams,r=n.length,o=n[r-1]?n[r-1].id:void 0;if(o===D){var i=document.getElementById(o);if(E.closable&&E.closeOnEscape&&"Escape"===e.key)be(e),e.stopImmediatePropagation(),n.splice(r-1,1);else if("Tab"===e.key){e.preventDefault();var a=d.getFocusableElements(i);if(a&&a.length>0)if(document.activeElement){var l=a.indexOf(document.activeElement);e.shiftKey?-1===l||0===l?a[a.length-1].focus():a[l-1].focus():-1===l||l===a.length-1?a[0].focus():a[l+1].focus()}else a[0].focus()}}}},we=function(e){d.hasClass(e.target,"p-dialog-header-icon")||d.hasClass(e.target.parentElement,"p-dialog-header-icon")||E.draggable&&($.current=!0,U.current=e.pageX,q.current=e.pageY,J.current.style.margin="0",d.addClass(document.body,"p-unselectable-text"),E.onDragStart&&E.onDragStart(e))},Se=function(e){if($.current){var t=d.getOuterWidth(J.current),n=d.getOuterHeight(J.current),r=e.pageX-U.current,o=e.pageY-q.current,i=J.current.getBoundingClientRect(),a=i.left+r,l=i.top+o,c=d.getViewport();J.current.style.position="fixed",E.keepInViewport?(a>=E.minX&&a+t<c.width&&(U.current=e.pageX,J.current.style.left=a+"px"),l>=E.minY&&l+n<c.height&&(q.current=e.pageY,J.current.style.top=l+"px")):(U.current=e.pageX,J.current.style.left=a+"px",q.current=e.pageY,J.current.style.top=l+"px"),E.onDrag&&E.onDrag(e)}},Ee=function(e){$.current&&($.current=!1,d.removeClass(document.body,"p-unselectable-text"),E.onDragEnd&&E.onDragEnd(e))},xe=function(e){E.resizable&&(K.current=!0,U.current=e.pageX,q.current=e.pageY,d.addClass(document.body,"p-unselectable-text"),E.onResizeStart&&E.onResizeStart(e))},ke=function(e,t,n){!n&&(n=d.getViewport());var r=parseInt(e);return/^(\d+|(\.\d+))(\.\d+)?%$/.test(e)?r*(n[t]/100):r},ze=function(e){if(K.current){var t=e.pageX-U.current,n=e.pageY-q.current,r=d.getOuterWidth(J.current),o=d.getOuterHeight(J.current),i=J.current.getBoundingClientRect(),a=d.getViewport(),l=!parseInt(J.current.style.top)||!parseInt(J.current.style.left),c=ke(J.current.style.minWidth,"width",a),u=ke(J.current.style.minHeight,"height",a),s=r+t,m=o+n;l&&(s+=t,m+=n),(!c||s>c)&&i.left+s<a.width&&(J.current.style.width=s+"px"),(!u||m>u)&&i.top+m<a.height&&(J.current.style.height=m+"px"),U.current=e.pageX,q.current=e.pageY,E.onResize&&E.onResize(e)}},Oe=function(e){K.current&&(K.current=!1,d.removeClass(document.body,"p-unselectable-text"),E.onResizeEnd&&E.onResizeEnd(e))},Ce=function(){J.current.style.position="",J.current.style.left="",J.current.style.top="",J.current.style.margin=""},Pe=function(){J.current.setAttribute(Q.current,"")},De=function(){var e;E.onShow&&E.onShow(),E.focusOnShow&&!((e=document.activeElement)&&J.current&&J.current.contains(e))&&E.closable&&E.showHeader&&F.current.focus(),Re()},Ie=function(){E.modal&&d.addClass(V.current,"p-component-overlay-leave"),E.blockScroll&&d.removeClass(document.body,"p-overflow-hidden")},Ne=function(){$.current=!1,p.clear(V.current),M(!1),je()},Re=function(){Me(),(E.blockScroll||E.maximizable&&ee)&&d.addClass(document.body,"p-overflow-hidden")},je=function(){Xe();var e=E.maximizable&&ee;E.modal?(document.primeDialogParams&&document.primeDialogParams.some((function(e){return e.hasBlockScroll}))||e)&&d.removeClass(document.body,"p-overflow-hidden"):(E.blockScroll||e)&&d.removeClass(document.body,"p-overflow-hidden")},Me=function(){E.draggable&&(me(),fe()),E.resizable&&(ie(),ce()),ne();var e,t={id:D,hasBlockScroll:E.blockScroll};document.primeDialogParams=document.primeDialogParams?[].concat(z(e=document.primeDialogParams)||O(e)||C(e)||P(),[t]):[t]},Xe=function(){de(),ge(),ae(),ue(),re(),document.primeDialogParams=document.primeDialogParams&&document.primeDialogParams.filter((function(e){return e.id!==D}))},He=function(){G.current=d.createInlineStyle(t.nonce);var e="";for(var n in E.breakpoints)e+="\n                @media screen and (max-width: ".concat(n,") {\n                    .p-dialog[").concat(Q.current,"] {\n                        width: ").concat(E.breakpoints[n]," !important;\n                    }\n                }\n            ");G.current.innerHTML=e};i((function(){E.visible&&M(!0),E.breakpoints&&He()})),a((function(){E.visible&&!N&&M(!0),E.visible!==A&&N&&T(E.visible)})),a((function(){N&&(p.set("modal",V.current,t.autoZIndex,E.baseZIndex||t.zIndex.modal),T(!0))}),[N]),a((function(){E.blockScroll||d[ee?"addClass":"removeClass"](document.body,"p-overflow-hidden")}),[E.maximized,B]),l((function(){je(),d.removeInlineStyle(G.current),p.clear(V.current)})),e.useImperativeHandle(S,(function(){return{props:E,resetPosition:Ce,getElement:function(){return J.current},getMask:function(){return V.current},getContent:function(){return L.current},getHeader:function(){return W.current},getFooter:function(){return Z.current},getCloseButton:function(){return F.current}}}));var Ae,Te,Ye,Be,_e,Je,Ve,Le,We,Ze=function(){if(E.closable){var t=E.ariaCloseIconLabel||n("close"),r={className:"p-dialog-header-close-icon","aria-hidden":!0},o=g.getJSXIcon(E.closeIcon||e.createElement(b,r),X({},r),{props:E});return e.createElement("button",{ref:F,type:"button",className:"p-dialog-header-icon p-dialog-header-close p-link","aria-label":t,onClick:be},o,e.createElement(u,null))}return null},Fe=function(){if(E.showHeader){var t=Ze(),n=(l="p-dialog-header-maximize-icon",c=g.getJSXIcon(ee?E.minimizeIcon||e.createElement(h,{className:l}):E.maximizeIcon||e.createElement(y,{className:l}),{className:l},{props:E}),E.maximizable?e.createElement("button",{type:"button",className:"p-dialog-header-icon p-dialog-header-maximize p-link",onClick:he},c,e.createElement(u,null)):null),r=s.getJSXElement(E.icons,E),o=s.getJSXElement(E.header,E),i=D+"_header",a=f("p-dialog-header",E.headerClassName);return e.createElement("div",{ref:W,style:E.headerStyle,className:a,onMouseDown:we},e.createElement("div",{id:i,className:"p-dialog-title"},o),e.createElement("div",{className:"p-dialog-header-icons"},r,n,t))}var l,c;return null},$e=function(){var t=f("p-dialog-content",E.contentClassName);return e.createElement("div",{id:D+"_content",ref:L,className:t,style:E.contentStyle},E.children)},Ke=function(){var t=s.getJSXElement(E.footer,E);return t&&e.createElement("div",{ref:Z,className:"p-dialog-footer"},t)};return N&&(Te=j.getOtherProps(E),Ye=f("p-dialog p-component",E.className,{"p-dialog-rtl":E.rtl,"p-dialog-maximized":ee,"p-dialog-default":!ee,"p-input-filled":"filled"===t.inputStyle,"p-ripple-disabled":!1===t.ripple}),Be=f("p-dialog-mask",(Ae=["center","left","right","top","top-left","top-right","bottom","bottom-left","bottom-right"].find((function(e){return e===E.position||e.replace("-","")===E.position})))?"p-dialog-".concat(Ae):"",{"p-component-overlay p-component-overlay-enter":E.modal,"p-dialog-visible":N,"p-dialog-draggable":E.draggable,"p-dialog-resizable":E.resizable},E.maskClassName),_e=Fe(),Je=$e(),Ve=Ke(),Le=E.resizable?e.createElement("span",{className:"p-resizable-handle",style:{zIndex:90},onMouseDown:xe}):null,We=e.createElement("div",{ref:V,style:E.maskStyle,className:Be,onClick:ye},e.createElement(r,{nodeRef:J,classNames:"p-dialog",timeout:{enter:"center"===E.position?150:300,exit:"center"===E.position?150:300},in:A,options:E.transitionOptions,unmountOnExit:!0,onEnter:Pe,onEntered:De,onExiting:Ie,onExited:Ne},e.createElement("div",v({ref:J,id:D,className:Ye,style:E.style,onClick:E.onClick,role:"dialog"},Te,{"aria-labelledby":D+"_header","aria-describedby":D+"_content","aria-modal":E.modal}),_e,Je,Ve,Le))),e.createElement(c,{element:We,appendTo:E.appendTo,visible:!0}))}));H.displayName="Dialog";export{H as Dialog};
