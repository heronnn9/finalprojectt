import*as e from"react";import t,{localeOption as n}from"primereact/api";import{CSSTransition as r}from"primereact/csstransition";import{useMountEffect as a,usePrevious as i,useResizeListener as l,useUpdateEffect as o,useInterval as c,useUnmountEffect as u}from"primereact/hooks";import{Portal as s}from"primereact/portal";import{Ripple as m}from"primereact/ripple";import{ObjectUtils as p,classNames as v,IconUtils as d,UniqueComponentId as f,DomHandler as h,ZIndexUtils as g}from"primereact/utils";import{ChevronLeftIcon as I}from"primereact/icons/chevronleft";import{ChevronRightIcon as b}from"primereact/icons/chevronright";import{ChevronUpIcon as y}from"primereact/icons/chevronup";import{ChevronDownIcon as x}from"primereact/icons/chevrondown";import{TimesIcon as w}from"primereact/icons/times";function S(){return S=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},S.apply(this,arguments)}function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function N(e,t){if("object"!==E(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==E(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function O(e){var t=N(e,"string");return"symbol"===E(t)?t:String(t)}function P(e,t,n){return(t=O(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(e){if(Array.isArray(e))return e}function C(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,l,o=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(o.push(r.value),o.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(u)throw a}}return o}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function k(e,t){if(e){if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(e,t):void 0}}function j(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function V(e,t){return T(e)||C(e,t)||k(e,t)||j()}var H={defaultProps:{__TYPE:"Galleria",id:null,value:null,activeIndex:0,fullScreen:!1,item:null,thumbnail:null,indicator:null,caption:null,className:null,closeIcon:null,style:null,header:null,footer:null,numVisible:3,responsiveOptions:null,showItemNavigators:!1,showThumbnailNavigators:!0,showItemNavigatorsOnHover:!1,changeItemOnIndicatorHover:!1,circular:!1,autoPlay:!1,transitionInterval:4e3,showThumbnails:!0,itemNextIcon:null,itemPrevIcon:null,nextThumbnailIcon:null,prevThumbnailIcon:null,thumbnailsPosition:"bottom",verticalThumbnailViewPortHeight:"300px",showIndicators:!1,showIndicatorsOnItem:!1,indicatorsPosition:"bottom",baseZIndex:0,transitionOptions:null,onItemChange:null,children:void 0},getProps:function(e){return p.getMergedProps(e,H.defaultProps)},getOtherProps:function(e){return p.getDiffProps(e,H.defaultProps)}},D=e.memo(e.forwardRef((function(t,n){var r=function(){t.slideShowActive&&t.stopSlideShow&&t.stopSlideShow()},i=function(e){r(),t.onActiveItemChange({index:t.circular&&0===t.activeItemIndex?t.value.length-1:0!==t.activeItemIndex?t.activeItemIndex-1:0}),e&&e.cancelable&&e.preventDefault()},l=function(e){r(),t.onActiveItemChange({index:t.circular&&t.value.length-1===t.activeItemIndex?0:t.activeItemIndex+1}),e&&e.cancelable&&e.preventDefault()},o=function(e){r(),t.onActiveItemChange({index:e})},c=function(e){t.changeItemOnIndicatorHover&&(r(),t.onActiveItemChange({index:e}))},u=function(e,n){13===e.which&&(r(),t.onActiveItemChange({index:n}))};a((function(){t.autoPlay&&t.startSlideShow()}));var s=function(n){var r="p-galleria-indicator-"+n,a=v("p-galleria-indicator",{"p-highlight":t.activeItemIndex===n}),i=t.indicator&&t.indicator(n);return i||(i=e.createElement("button",{type:"button",tabIndex:-1,className:"p-link"},e.createElement(m,null))),e.createElement("li",{className:a,key:r,tabIndex:0,onClick:function(){return o(n)},onMouseEnter:function(){return c(n)},onKeyDown:function(e){return u(e,n)}},i)},p=t.itemTemplate&&t.itemTemplate(t.value[t.activeItemIndex]),f=function(){if(t.showItemNavigators){var n=!t.circular&&0===t.activeItemIndex,r=v("p-galleria-item-prev p-galleria-item-nav p-link",{"p-disabled":n}),a="p-galleria-item-prev-icon",l=d.getJSXIcon(t.itemPrevIcon||e.createElement(I,{className:a}),{className:a},{props:t});return e.createElement("button",{type:"button",className:r,onClick:i,disabled:n},l,e.createElement(m,null))}return null}(),h=function(){if(t.showItemNavigators){var n=!t.circular&&t.activeItemIndex===t.value.length-1,r=v("p-galleria-item-next p-galleria-item-nav p-link",{"p-disabled":n}),a="p-galleria-item-next-icon",i=d.getJSXIcon(t.itemNextIcon||e.createElement(b,{className:a}),{className:a},{props:t});return e.createElement("button",{type:"button",className:r,onClick:l,disabled:n},i,e.createElement(m,null))}return null}(),g=function(){if(t.caption){var n=t.caption(t.value[t.activeItemIndex]);return e.createElement("div",{className:"p-galleria-caption"},n)}return null}(),y=function(){if(t.showIndicators){for(var n=v("p-galleria-indicators p-reset",t.indicatorsContentClassName),r=[],a=0;a<t.value.length;a++)r.push(s(a));return e.createElement("ul",{className:n},r)}return null}();return e.createElement("div",{ref:n,className:"p-galleria-item-wrapper"},e.createElement("div",{className:"p-galleria-item-container"},f,e.createElement("div",{className:"p-galleria-item"},p),h,g),y)})));function R(e){if(Array.isArray(e))return A(e)}function M(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function X(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}D.displayName="GalleriaItem";var G=e.memo((function(t){var n=t.active?0:null,r=t.template&&t.template(t.item),a=v("p-galleria-thumbnail-item",{"p-galleria-thumbnail-item-current":t.current,"p-galleria-thumbnail-item-active":t.active,"p-galleria-thumbnail-item-start":t.start,"p-galleria-thumbnail-item-end":t.end},t.className);return e.createElement("div",{className:a},e.createElement("div",{className:"p-galleria-thumbnail-item-content",tabIndex:n,onClick:function(e){t.onItemClick({originalEvent:e,index:t.index})},onKeyDown:function(e){13===e.which&&t.onItemClick({originalEvent:e,index:t.index})}},r))})),J=e.memo(e.forwardRef((function(n,r){var c=V(e.useState(n.numVisible),2),u=c[0],s=c[1],g=V(e.useState(0),2),w=g[0],S=g[1],E=e.useRef(null),N=e.useRef(null),O=e.useRef(""),P=e.useRef(null),T=e.useRef(null),C=i(u),A=i(n.activeItemIndex),j=V(l({listener:function(){B()},when:n.responsiveOptions}),1)[0],H=function(e){var t=w+e;e<0&&-1*t+u>n.value.length-1?t=u-n.value.length:e>0&&t>0&&(t=0),n.circular&&(e<0&&n.value.length-1===n.activeItemIndex?t=0:e>0&&0===n.activeItemIndex&&(t=u-n.value.length)),E.current&&(h.removeClass(E.current,"p-items-hidden"),E.current.style.transform=n.isVertical?"translate3d(0, ".concat(t*(100/u),"%, 0)"):"translate3d(".concat(t*(100/u),"%, 0, 0)"),E.current.style.transition="transform 500ms ease 0s"),S(t)},D=function(){n.slideShowActive&&n.stopSlideShow&&n.stopSlideShow()},J=function(){var e=Math.floor(u/2);return u%2?e:e-1},Y=function(e){D();var t=0!==n.activeItemIndex?n.activeItemIndex-1:0;u-(t+w)-1>J()&&(-1*w!=0||n.circular)&&H(1),n.onActiveItemChange({index:n.circular&&0===n.activeItemIndex?n.value.length-1:t}),e.cancelable&&e.preventDefault()},Z=function(e){D();var t=n.activeItemIndex+1;t+w>J()&&(-1*w<$()-1||n.circular)&&H(-1),n.onActiveItemChange({index:n.circular&&n.value.length-1===n.activeItemIndex?0:t}),e.cancelable&&e.preventDefault()},K=function(e){D();var t=e.index;if(t!==n.activeItemIndex){var r=t+w,a=0;t<n.activeItemIndex?(a=u-r-1-J())>0&&-1*w!=0&&H(a):(a=J()-r)<0&&-1*w<$()-1&&H(a),n.onActiveItemChange({index:t})}},_=function(e){E.current&&"transform"===e.propertyName&&(h.addClass(E.current,"p-items-hidden"),E.current.style.transition="")},z=function(e){var t=e.changedTouches[0];N.current={x:t.pageX,y:t.pageY}},L=function(e){e.cancelable&&e.preventDefault()},U=function(e){var t=e.changedTouches[0];W(e,n.isVertical?t.pageY-N.current.y:t.pageX-N.current.x)},W=function(e,t){t<0?Z(e):Y(e)},$=function(){return n.value.length>u?n.value.length-u+1:0},q=function(){P.current||(P.current=h.createInlineStyle(t.nonce));var e,r="\n            .p-galleria-thumbnail-items[".concat(O.current,"] .p-galleria-thumbnail-item {\n                flex: 1 0 ").concat(100/u,"%\n            }\n        ");if(n.responsiveOptions){T.current=R(e=n.responsiveOptions)||M(e)||k(e)||X(),T.current.sort((function(e,n){return p.sort(e.breakpoint,n.breakpoint,-1,t.locale,t.nullSortOrder)}));for(var a=0;a<T.current.length;a++){var i=T.current[a];r+="\n                    @media screen and (max-width: ".concat(i.breakpoint,") {\n                        .p-galleria-thumbnail-items[").concat(O.current,"] .p-galleria-thumbnail-item {\n                            flex: 1 0 ").concat(100/i.numVisible,"%\n                        }\n                    }\n                ")}}P.current.innerHTML=r},B=function(){if(E.current&&T.current){for(var e=window.innerWidth,t={numVisible:n.numVisible},r=0;r<T.current.length;r++){var a=T.current[r];parseInt(a.breakpoint,10)>=e&&(t=a)}u!==t.numVisible&&s(t.numVisible)}};a((function(){E.current&&(O.current=f(),E.current.setAttribute(O.current,"")),q(),B(),j()})),o((function(){var e=w;C===u&&A===n.activeItemIndex||((e=n.activeItemIndex<=J()?0:n.value.length-u+J()<n.activeItemIndex?u-n.value.length:n.value.length-u<n.activeItemIndex&&u%2==0?-1*n.activeItemIndex+J()+1:-1*n.activeItemIndex+J())!==w&&S(e),E.current.style.transform=n.isVertical?"translate3d(0, ".concat(e*(100/u),"%, 0)"):"translate3d(".concat(e*(100/u),"%, 0, 0)"),A!==n.activeItemIndex&&(h.removeClass(E.current,"p-items-hidden"),E.current.style.transition="transform 500ms ease 0s"))}));var F,Q,ee,te,ne=function(){if(n.showThumbnailNavigators){var t=!n.circular&&0===n.activeItemIndex||n.value.length<=u,r=v("p-galleria-thumbnail-prev p-link",{"p-disabled":t}),a="p-galleria-thumbnail-prev-icon",i=d.getJSXIcon(n.isVertical?n.prevThumbnailIcon||e.createElement(y,{className:a}):n.prevThumbnailIcon||e.createElement(I,{className:a}),{className:a},{props:n});return e.createElement("button",{className:r,onClick:Y,disabled:t},i,e.createElement(m,null))}return null},re=function(){if(n.showThumbnailNavigators){var t=!n.circular&&n.activeItemIndex===n.value.length-1||n.value.length<=u,r=v("p-galleria-thumbnail-next p-link",{"p-disabled":t}),a="p-galleria-thumbnail-next-icon",i=d.getJSXIcon(n.isVertical?n.nextThumbnailIcon||e.createElement(x,{className:a}):n.nextThumbnailIcon||e.createElement(b,{className:a}),{className:a},{props:n});return e.createElement("button",{className:r,onClick:Z,disabled:t},i,e.createElement(m,null))}return null},ae=(F=n.value.map((function(t,r){var a=-1*w,i=a+u-1;return e.createElement(G,{key:r,index:r,template:n.itemTemplate,item:t,active:a<=r&&i>=r,start:a===r,end:i===r,onItemClick:K,current:n.activeItemIndex===r})})),Q=n.isVertical?n.contentHeight:"",ee=ne(),te=re(),e.createElement("div",{className:"p-galleria-thumbnail-container"},ee,e.createElement("div",{className:"p-galleria-thumbnail-items-container",style:{height:Q}},e.createElement("div",{ref:E,className:"p-galleria-thumbnail-items",onTransitionEnd:_,onTouchStart:z,onTouchMove:L,onTouchEnd:U},F)),te));return e.createElement("div",{className:"p-galleria-thumbnail-wrapper"},ae)})));function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}G.displayName="GalleriaThumbnailItem",J.displayName="GalleriaThumbnails";var K=e.memo(e.forwardRef((function(a,i){var l=H.getProps(a),o=V(e.useState(!1),2),f=o[0],I=o[1],b=V(e.useState(l.numVisible),2),y=b[0],x=b[1],E=V(e.useState(!1),2),N=E[0],O=E[1],P=V(e.useState(l.activeIndex),2),T=P[0],C=P[1],A=e.useRef(null),k=e.useRef(null),j=e.useRef(null),R=l.onItemChange?l.activeIndex:T,M="left"===l.thumbnailsPosition||"right"===l.thumbnailsPosition;c((function(){X({index:l.circular&&l.value.length-1===R?0:R+1})}),l.transitionInterval,N);var X=function(e){l.onItemChange?l.onItemChange(e):C(e.index)},G=function(){I(!0)},Y=function(){I(!1)},K=function(){h.addClass(document.body,"p-overflow-hidden")},_=function(){g.set("modal",j.current,t.autoZIndex,l.baseZIndex||t.zIndex.modal),h.addMultipleClasses(j.current,"p-component-overlay p-component-overlay-enter")},z=function(){l.onShow&&l.onShow()},L=function(){h.removeClass(document.body,"p-overflow-hidden"),h.addClass(j.current,"p-component-overlay-leave")},U=function(){g.clear(j.current),l.onHide&&l.onHide()},W=function(){return N},$=function(){O(!0)},q=function(){O(!1)},B=function(e,t){var n=["top","left","bottom","right"].find((function(e){return e===t}));return n?"".concat(e,"-").concat(n):""};e.useEffect((function(){l.value&&l.value.length<y&&x(l.value.length)}),[l.value,y]),e.useEffect((function(){x(l.numVisible)}),[l.numVisible]),u((function(){N&&q(),g.clear(j.current)})),e.useImperativeHandle(i,(function(){return{props:l,show:G,hide:Y,isAutoPlayActive:W,startSlideShow:$,stopSlideShow:q,getElement:function(){return A.current},getPreviewContent:function(){return k.current}}}));return p.isNotEmpty(l.value)&&function(){var a,i,o,c,u,p,h,g,I,b=(a=H.getOtherProps(l),i=l.showThumbnails&&B("p-galleria-thumbnails",l.thumbnailsPosition),o=l.showIndicators&&B("p-galleria-indicators",l.indicatorsPosition),c=v("p-galleria p-component",l.className,{"p-galleria-fullscreen":l.fullScreen,"p-galleria-indicator-onitem":l.showIndicatorsOnItem,"p-galleria-item-nav-onhover":l.showItemNavigatorsOnHover&&!l.fullScreen,"p-input-filled":"filled"===t.inputStyle,"p-ripple-disabled":!1===t.ripple},i,o),u={className:"p-galleria-close-icon","aria-hidden":!0},p=d.getJSXIcon(l.closeIcon||e.createElement(w,u),Z({},u),{props:l}),h=l.fullScreen&&e.createElement("button",{type:"button",className:"p-galleria-close p-link","aria-label":n("close"),onClick:Y},p,e.createElement(m,null)),g=l.header?e.createElement("div",{className:"p-galleria-header"},l.header):null,I=l.footer?e.createElement("div",{className:"p-galleria-footer"},l.footer):null,e.createElement("div",S({ref:A,id:l.id,className:c,style:l.style},a),h,g,e.createElement("div",{className:"p-galleria-content"},e.createElement(D,{ref:k,value:l.value,activeItemIndex:R,onActiveItemChange:X,itemTemplate:l.item,circular:l.circular,caption:l.caption,showIndicators:l.showIndicators,itemPrevIcon:l.itemPrevIcon,itemNextIcon:l.itemNextIcon,changeItemOnIndicatorHover:l.changeItemOnIndicatorHover,indicator:l.indicator,showItemNavigators:l.showItemNavigators,autoPlay:l.autoPlay,slideShowActive:N,startSlideShow:$,stopSlideShow:q}),l.showThumbnails&&e.createElement(J,{value:l.value,activeItemIndex:R,onActiveItemChange:X,itemTemplate:l.thumbnail,numVisible:y,nextThumbnailIcon:l.nextThumbnailIcon,prevThumbnailIcon:l.prevThumbnailIcon,responsiveOptions:l.responsiveOptions,circular:l.circular,isVertical:M,contentHeight:l.verticalThumbnailViewPortHeight,showThumbnailNavigators:l.showThumbnailNavigators,autoPlay:l.autoPlay,slideShowActive:N,stopSlideShow:q})),I));if(l.fullScreen){var x=v("p-galleria-mask",{"p-galleria-visible":f});return e.createElement(s,{element:e.createElement("div",{ref:j,className:x},e.createElement(r,{nodeRef:A,classNames:"p-galleria",in:f,timeout:{enter:150,exit:150},options:l.transitionOptions,unmountOnExit:!0,onEnter:K,onEntering:_,onEntered:z,onExit:L,onExited:U},b))})}return b}()})));K.displayName="Galleria";export{K as Galleria};
