import*as e from"react";import{ObjectUtils as n,classNames as t,DomHandler as r,IconUtils as o}from"primereact/utils";import{ariaLabel as l}from"primereact/api";import{Ripple as a}from"primereact/ripple";import{CheckIcon as i}from"primereact/icons/check";import{ChevronDownIcon as c}from"primereact/icons/chevrondown";import{ChevronRightIcon as d}from"primereact/icons/chevronright";import{MinusIcon as p}from"primereact/icons/minus";import{SearchIcon as u}from"primereact/icons/search";import{SpinnerIcon as s}from"primereact/icons/spinner";function f(){return f=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},f.apply(this,arguments)}function g(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function m(e){if(Array.isArray(e))return g(e)}function y(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function h(e,n){if(e){if("string"==typeof e)return g(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?g(e,n):void 0}}function v(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function S(e,n){if("object"!==b(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!==b(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}function x(e){var n=S(e,"string");return"symbol"===b(n)?n:String(n)}function E(e,n,t){return(n=x(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function C(e){if(Array.isArray(e))return e}function k(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,l,a,i=[],c=!0,d=!1;try{if(l=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;c=!1}else for(;!(c=(r=l.call(t)).done)&&(i.push(r.value),i.length!==n);c=!0);}catch(e){d=!0,o=e}finally{try{if(!c&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(d)throw o}}return i}}function D(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function N(e,n){return C(e)||k(e,n)||h(e,n)||D()}var O={defaultProps:{__TYPE:"Tree",id:null,value:null,checkboxIcon:null,disabled:!1,selectionMode:null,selectionKeys:null,onSelectionChange:null,contextMenuSelectionKey:null,onContextMenuSelectionChange:null,expandedKeys:null,style:null,className:null,contentStyle:null,contentClassName:null,metaKeySelection:!0,propagateSelectionUp:!0,propagateSelectionDown:!0,loading:!1,loadingIcon:null,expandIcon:null,collapseIcon:null,dragdropScope:null,header:null,footer:null,showHeader:!0,filter:!1,filterIcon:null,filterValue:null,filterBy:"label",filterMode:"lenient",filterPlaceholder:null,filterLocale:void 0,filterTemplate:null,nodeTemplate:null,togglerTemplate:null,onSelect:null,onUnselect:null,onExpand:null,onCollapse:null,onToggle:null,onDragDrop:null,onContextMenu:null,onFilterValueChange:null,onNodeClick:null,onNodeDoubleClick:null,children:void 0},getProps:function(e){return n.getMergedProps(e,O.defaultProps)},getOtherProps:function(e){return n.getDiffProps(e,O.defaultProps)}};function w(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=K(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){i=!0,l=e},f:function(){try{a||null==t.return||t.return()}finally{if(i)throw l}}}}function K(e,n){if(e){if("string"==typeof e)return T(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?T(e,n):void 0}}function T(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function I(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function P(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?I(Object(t),!0).forEach((function(n){E(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):I(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var M=e.memo((function(u){var s,f,g,m=e.useRef(null),y=e.useRef(!1),h=u.isNodeLeaf(u.node),v=!!u.expandedKeys&&void 0!==u.expandedKeys[u.node.key]||u.node.expanded,b=function(e){var n=u.expandedKeys?P({},u.expandedKeys):{};n[u.node.key]=!0,u.onToggle({originalEvent:e,value:n}),E(e,!0)},S=function(e){var n=P({},u.expandedKeys);delete n[u.node.key],u.onToggle({originalEvent:e,value:n}),E(e,!1)},x=function(e){u.disabled||(v?S(e):b(e),e.preventDefault(),e.stopPropagation())},E=function(e,n){n?u.onExpand&&u.onExpand({originalEvent:e,node:u.node}):u.onCollapse&&u.onCollapse({originalEvent:e,node:u.node})},C=function(e){if(!u.disabled){var n=e.target.parentElement;if(r.hasClass(n,"p-treenode"))switch(e.which){case 40:var t=n.children[1];if(t)O(t.children[0]);else{for(var o=n.nextElementSibling;o&&r.hasClass(o,"p-treenode-droppoint");)o=o.nextElementSibling;if(o)O(o);else{var l=k(n);l&&O(l)}}e.preventDefault();break;case 38:if(n.previousElementSibling)O(D(n.previousElementSibling));else{var a=N(n);a&&O(a)}e.preventDefault();break;case 39:v||b(e),e.preventDefault();break;case 37:v&&S(e),e.preventDefault();break;case 13:K(e),e.preventDefault()}}},k=function e(n){var t=N(n);return t?t.nextElementSibling||e(t):null},D=function e(n){var t=n.children[1];return t?e(t.children[t.children.length-1]):n},N=function(e){var n=e.parentElement.parentElement;return r.hasClass(n,"p-treenode")?n:null},O=function(e){e&&e.children[0]&&e.children[0].focus()},K=function(e){u.onClick&&u.onClick({originalEvent:e,node:u.node});var n=e.target.nodeName;if(!u.disabled&&"INPUT"!==n&&"BUTTON"!==n&&"A"!==n&&!r.hasClass(e.target,"p-clickable")){if(u.selectionMode&&!1!==u.node.selectable){var t;if(R()){var o=A();t=u.selectionKeys?P({},u.selectionKeys):{},o?(u.propagateSelectionDown?U(u.node,!1,t):delete t[u.node.key],u.propagateSelectionUp&&u.onPropagateUp&&u.onPropagateUp({originalEvent:e,check:!1,selectionKeys:t}),u.onUnselect&&u.onUnselect({originalEvent:e,node:u.node})):(u.propagateSelectionDown?U(u.node,!0,t):t[u.node.key]={checked:!0},u.propagateSelectionUp&&u.onPropagateUp&&u.onPropagateUp({originalEvent:e,check:!0,selectionKeys:t}),u.onSelect&&u.onSelect({originalEvent:e,node:u.node}))}else{var l=L();if(!y.current&&u.metaKeySelection){var a=e.metaKey||e.ctrlKey;l&&a?(J()?t=null:delete(t=P({},u.selectionKeys))[u.node.key],u.onUnselect&&u.onUnselect({originalEvent:e,node:u.node})):(J()?t=u.node.key:F()&&((t=a&&u.selectionKeys?P({},u.selectionKeys):{})[u.node.key]=!0),u.onSelect&&u.onSelect({originalEvent:e,node:u.node}))}else J()?l?(t=null,u.onUnselect&&u.onUnselect({originalEvent:e,node:u.node})):(t=u.node.key,u.onSelect&&u.onSelect({originalEvent:e,node:u.node})):l?(delete(t=P({},u.selectionKeys))[u.node.key],u.onUnselect&&u.onUnselect({originalEvent:e,node:u.node})):((t=u.selectionKeys?P({},u.selectionKeys):{})[u.node.key]=!0,u.onSelect&&u.onSelect({originalEvent:e,node:u.node}))}u.onSelectionChange&&u.onSelectionChange({originalEvent:e,value:t})}y.current=!1}},T=function(e){u.onDoubleClick&&u.onDoubleClick({originalEvent:e,node:u.node})},I=function(e){u.disabled||(r.clearSelection(),u.onContextMenuSelectionChange&&u.onContextMenuSelectionChange({originalEvent:e,value:u.node.key}),u.onContextMenu&&u.onContextMenu({originalEvent:e,node:u.node}))},j=function(e){var n,t=e.check,r=e.selectionKeys,o=0,l=!1,a=w(u.node.children);try{for(a.s();!(n=a.n()).done;){var i=n.value;r[i.key]&&r[i.key].checked?o++:r[i.key]&&r[i.key].partialChecked&&(l=!0)}}catch(e){a.e(e)}finally{a.f()}t&&o===u.node.children.length?r[u.node.key]={checked:!0,partialChecked:!1}:(t||delete r[u.node.key],l||o>0&&o!==u.node.children.length?r[u.node.key]={checked:!1,partialChecked:!0}:delete r[u.node.key]),u.propagateSelectionUp&&u.onPropagateUp&&u.onPropagateUp(e)},U=function e(n,t,r){if(t?r[n.key]={checked:!0,partialChecked:!1}:delete r[n.key],n.children&&n.children.length)for(var o=0;o<n.children.length;o++)e(n.children[o],t,r)},L=function(){return!(!u.selectionMode||!u.selectionKeys)&&(J()?u.selectionKeys===u.node.key:void 0!==u.selectionKeys[u.node.key])},A=function(){return!!u.selectionKeys&&(u.selectionKeys[u.node.key]&&u.selectionKeys[u.node.key].checked)},J=function(){return u.selectionMode&&"single"===u.selectionMode},F=function(){return u.selectionMode&&"multiple"===u.selectionMode},R=function(){return u.selectionMode&&"checkbox"===u.selectionMode},X=function(){y.current=!0},V=function(e,n){(e.preventDefault(),!1!==u.node.droppable)&&(r.removeClass(e.target,"p-treenode-droppoint-active"),u.onDropPoint&&u.onDropPoint({originalEvent:e,path:u.path,index:-1===n?u.index:u.index+1,position:n}))},B=function(e){e.dataTransfer.types[1]===u.dragdropScope.toLocaleLowerCase()&&(e.dataTransfer.dropEffect="move",e.preventDefault())},H=function(e){e.dataTransfer.types[1]===u.dragdropScope.toLocaleLowerCase()&&r.addClass(e.target,"p-treenode-droppoint-active")},$=function(e){e.dataTransfer.types[1]===u.dragdropScope.toLocaleLowerCase()&&r.removeClass(e.target,"p-treenode-droppoint-active")},_=function(e){u.dragdropScope&&!1!==u.node.droppable&&(r.removeClass(m.current,"p-treenode-dragover"),e.preventDefault(),e.stopPropagation(),u.onDrop&&u.onDrop({originalEvent:e,path:u.path,index:u.index}))},Y=function(e){e.dataTransfer.types[1]===u.dragdropScope.toLocaleLowerCase()&&!1!==u.node.droppable&&(e.dataTransfer.dropEffect="move",e.preventDefault(),e.stopPropagation())},q=function(e){e.dataTransfer.types[1]===u.dragdropScope.toLocaleLowerCase()&&!1!==u.node.droppable&&r.addClass(m.current,"p-treenode-dragover")},z=function(e){if(e.dataTransfer.types[1]===u.dragdropScope.toLocaleLowerCase()&&!1!==u.node.droppable){var n=e.currentTarget.getBoundingClientRect();(e.nativeEvent.x>n.left+n.width||e.nativeEvent.x<n.left||e.nativeEvent.y>=Math.floor(n.top+n.height)||e.nativeEvent.y<n.top)&&r.removeClass(m.current,"p-treenode-dragover")}},G=function(e){e.dataTransfer.setData("text",u.dragdropScope),e.dataTransfer.setData(u.dragdropScope,u.dragdropScope),u.onDragStart&&u.onDragStart({originalEvent:e,path:u.path,index:u.index})},Q=function(e){u.onDragEnd&&u.onDragEnd({originalEvent:e})},W=function(){var t=e.createElement("span",{className:"p-treenode-label"},u.node.label);u.nodeTemplate&&(t=n.getJSXElement(u.nodeTemplate,u.node,{onTogglerClick:x,className:"p-treenode-label",element:t,props:u,expanded:v}));return t},Z=function(){if(R()&&!1!==u.node.selectable){var n=A(),r=!!u.selectionKeys&&u.selectionKeys[u.node.key]&&u.selectionKeys[u.node.key].partialChecked,l=t("p-checkbox-box",{"p-highlight":n,"p-indeterminate":r,"p-disabled":u.disabled}),a="p-checkbox-icon p-c",c=o.getJSXIcon(n?u.checkboxIcon||e.createElement(i,{className:a}):r?u.checkboxIcon||e.createElement(p,{className:a}):null,{className:a},u);return e.createElement("div",{className:"p-checkbox p-component"},e.createElement("div",{className:l,role:"checkbox","aria-checked":n},c))}return null},ee=function(){var n=u.node.icon||(v?u.node.expandedIcon:u.node.collapsedIcon);if(n){var r=t("p-treenode-icon",n);return e.createElement("span",{className:r})}return null},ne=function(){var t=l(v?"collapseLabel":"expandLabel"),r={className:"p-tree-toggler-icon","aria-hidden":!0},i=o.getJSXIcon(v?u.collapseIcon||e.createElement(c,r):u.expandIcon||e.createElement(d,r),P({},r),{props:u,expanded:v}),p=e.createElement("button",{type:"button",className:"p-tree-toggler p-link",tabIndex:-1,onClick:x,"aria-label":t},i,e.createElement(a,null));u.togglerTemplate&&(p=n.getJSXElement(u.togglerTemplate,u.node,{onClick:x,containerClassName:"p-tree-toggler p-link",iconClassName:"p-tree-toggler-icon",element:p,props:u,expanded:v}));return p},te=function(n){return u.dragdropScope?e.createElement("li",{className:"p-treenode-droppoint",onDrop:function(e){return V(e,n)},onDragOver:B,onDragEnter:H,onDragLeave:$}):null},re=function(){var n=L(),r=A(),o=t("p-treenode-content",u.node.className,{"p-treenode-selectable":u.selectionMode&&!1!==u.node.selectable,"p-highlight":R()?r:n,"p-highlight-contextmenu":u.contextMenuSelectionKey&&u.contextMenuSelectionKey===u.node.key,"p-disabled":u.disabled}),l=ne(),a=Z(),i=ee(),c=W();return e.createElement("div",{ref:m,className:o,style:u.node.style,onClick:K,onDoubleClick:T,onContextMenu:I,onTouchEnd:X,draggable:u.dragdropScope&&!1!==u.node.draggable&&!u.disabled,onDrop:_,onDragOver:Y,onDragEnter:q,onDragLeave:z,onDragStart:G,onDragEnd:Q,tabIndex:u.disabled?void 0:0,onKeyDown:C,role:"treeitem","aria-posinset":u.index+1,"aria-expanded":v,"aria-selected":r||n},l,a,i,c)},oe=(s=t("p-treenode",{"p-treenode-leaf":h},u.node.className),f=re(),g=n.isNotEmpty(u.node.children)&&v?e.createElement("ul",{className:"p-treenode-children",role:"group"},u.node.children.map((function(n,t){return e.createElement(M,{key:n.key||n.label,node:n,parent:u.node,index:t,last:t===u.node.children.length-1,path:u.path+"-"+t,disabled:u.disabled,selectionMode:u.selectionMode,selectionKeys:u.selectionKeys,onSelectionChange:u.onSelectionChange,metaKeySelection:u.metaKeySelection,propagateSelectionDown:u.propagateSelectionDown,propagateSelectionUp:u.propagateSelectionUp,contextMenuSelectionKey:u.contextMenuSelectionKey,onContextMenuSelectionChange:u.onContextMenuSelectionChange,onContextMenu:u.onContextMenu,onExpand:u.onExpand,onCollapse:u.onCollapse,onSelect:u.onSelect,onUnselect:u.onUnselect,onClick:u.onClick,onDoubleClick:u.onDoubleClick,expandedKeys:u.expandedKeys,onToggle:u.onToggle,onPropagateUp:j,nodeTemplate:u.nodeTemplate,togglerTemplate:u.togglerTemplate,isNodeLeaf:u.isNodeLeaf,dragdropScope:u.dragdropScope,onDragStart:u.onDragStart,onDragEnd:u.onDragEnd,onDrop:u.onDrop,onDropPoint:u.onDropPoint})}))):null,e.createElement("li",{className:s,style:u.node.style},f,g));if(u.dragdropScope&&!u.disabled){var le=te(-1),ae=u.last?te(1):null;return e.createElement(e.Fragment,null,le,oe,ae)}return oe}));function j(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function U(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?j(Object(t),!0).forEach((function(n){E(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):j(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function L(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=A(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){i=!0,l=e},f:function(){try{a||null==t.return||t.return()}finally{if(i)throw l}}}}function A(e,n){if(e){if("string"==typeof e)return J(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?J(e,n):void 0}}function J(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}M.displayName="UITreeNode";var F=e.memo(e.forwardRef((function(l,a){var i=O.getProps(l),c=N(e.useState(""),2),d=c[0],p=c[1],g=N(e.useState(i.expandedKeys),2),b=g[0],S=g[1],x=e.useRef(null),E=e.useRef([]),C=e.useRef(null),k=e.useRef(!1),D=i.onFilterValueChange?i.filterValue:d,w=i.onToggle?i.expandedKeys:b,K={filter:function(e){return $(e)},reset:function(){return G()}},T=function(e){i.onToggle?i.onToggle(e):S(e.value)},I=function(e){C.current={path:e.path,index:e.index}},P=function(){C.current=null},j=function(e){if(F(C.current.path,e.path)){var n=JSON.parse(JSON.stringify(i.value)),t=C.current.path.split("-");t.pop();var r=V(n,t),o=r?r.children[C.current.index]:n[C.current.index],l=V(n,e.path.split("-"));l.children?l.children.push(o):l.children=[o],r?r.children.splice(C.current.index,1):n.splice(C.current.index,1),i.onDragDrop&&i.onDragDrop({originalEvent:e.originalEvent,value:n,dragNode:o,dropNode:l,dropIndex:e.index})}},A=function(e){if(R(e)){var n=JSON.parse(JSON.stringify(i.value)),t=C.current.path.split("-");t.pop();var r=e.path.split("-");r.pop();var o=V(n,t),l=V(n,r),a=o?o.children[C.current.index]:n[C.current.index],c=X(C.current.path,e.path);if(o?o.children.splice(C.current.index,1):n.splice(C.current.index,1),e.position<0){var d=c?C.current.index>e.index?e.index:e.index-1:e.index;l?l.children.splice(d,0,a):n.splice(d,0,a)}else l?l.children.push(a):n.push(a);i.onDragDrop&&i.onDragDrop({originalEvent:e.originalEvent,value:n,dragNode:a,dropNode:l,dropIndex:e.index})}},J=function(e,n){return!!e&&(e!==n&&0!==n.indexOf(e))},F=function(e,n){return!!J(e,n)&&!(e.indexOf("-")>0&&e.substring(0,e.lastIndexOf("-"))===n)},R=function(e){return!!J(C.current.path,e.path)&&(-1!==e.position||!X(C.current.path,e.path)||C.current.index+1!==e.index)},X=function(e,n){return 1===e.length&&1===n.length||e.substring(0,e.lastIndexOf("-"))===n.substring(0,n.lastIndexOf("-"))},V=function e(n,t){if(0===t.length)return null;var r=parseInt(t[0],10),o=n.children?n.children[r]:n[r];return 1===t.length?o:(t.shift(),e(o,t))},B=function(e){return!1!==e.leaf&&!(e.children&&e.children.length)},H=function(e){13===e.which&&e.preventDefault()},$=function(e){k.current=!0;var n=e.target.value;i.onFilterValueChange?i.onFilterValueChange({originalEvent:e,value:n}):p(n)},_=function(e){p(n.isNotEmpty(e)?e:""),Y()},Y=function(){if(k.current){if(n.isEmpty(D))E.current=i.value;else{E.current=[];var e,t=i.filterBy.split(","),r=D.toLocaleLowerCase(i.filterLocale),o="strict"===i.filterMode,l=L(i.value);try{for(l.s();!(e=l.n()).done;){var a=U({},e.value),c={searchFields:t,filterText:r,isStrictMode:o};(o&&(q(a,c)||z(a,c))||!o&&(z(a,c)||q(a,c)))&&E.current.push(a)}}catch(e){l.e(e)}finally{l.f()}}k.current=!1}},q=function(e,n){if(e){var t=!1;if(e.children){var r=m(i=e.children)||y(i)||h(i)||v();e.children=[];var o,l=L(r);try{for(l.s();!(o=l.n()).done;){var a=U({},o.value);z(a,n)&&(t=!0,e.children.push(a))}}catch(e){l.e(e)}finally{l.f()}}if(t)return e.expanded=!0,!0}var i},z=function(e,t){var r,o=t.searchFields,l=t.filterText,a=t.isStrictMode,c=!1,d=L(o);try{for(d.s();!(r=d.n()).done;){String(n.resolveFieldData(e,r.value)).toLocaleLowerCase(i.filterLocale).indexOf(l)>-1&&(c=!0)}}catch(e){d.e(e)}finally{d.f()}return(!c||a&&!B(e))&&(c=q(e,{searchFields:o,filterText:l,isStrictMode:a})||c),c},G=function(){p("")};e.useImperativeHandle(a,(function(){return{props:i,filter:_,getElement:function(){return x.current}}}));var Q=function(n,t,r){return e.createElement(M,{key:n.key||n.label,node:n,index:t,last:r,path:String(t),checkboxIcon:i.checkboxIcon,expandIcon:i.expandIcon,collapseIcon:i.collapseIcon,disabled:i.disabled,selectionMode:i.selectionMode,selectionKeys:i.selectionKeys,onSelectionChange:i.onSelectionChange,metaKeySelection:i.metaKeySelection,contextMenuSelectionKey:i.contextMenuSelectionKey,onContextMenuSelectionChange:i.onContextMenuSelectionChange,onContextMenu:i.onContextMenu,propagateSelectionDown:i.propagateSelectionDown,propagateSelectionUp:i.propagateSelectionUp,onExpand:i.onExpand,onCollapse:i.onCollapse,onSelect:i.onSelect,onUnselect:i.onUnselect,expandedKeys:w,onToggle:T,nodeTemplate:i.nodeTemplate,togglerTemplate:i.togglerTemplate,isNodeLeaf:B,dragdropScope:i.dragdropScope,onDragStart:I,onDragEnd:P,onDrop:j,onDropPoint:A,onClick:i.onNodeClick,onDoubleClick:i.onNodeDoubleClick})},W=function(){i.filter&&(k.current=!0,Y());var e=i.filter&&E.current?E.current:i.value;return e.map((function(n,t){return Q(n,t,t===e.length-1)}))},Z=function(){if(i.filter){var t=n.isNotEmpty(D)?D:"",r="p-tree-filter-icon",l=o.getJSXIcon(i.filterIcon||e.createElement(u,{className:r}),{className:r},{props:i}),a=e.createElement("div",{className:"p-tree-filter-container"},e.createElement("input",{type:"text",value:t,autoComplete:"off",className:"p-tree-filter p-inputtext p-component",placeholder:i.filterPlaceholder,onKeyDown:H,onChange:$,disabled:i.disabled}),l);if(i.filterTemplate)a=n.getJSXElement(i.filterTemplate,{className:"p-tree-filter-container",element:a,filterOptions:K,filterInputKeyDown:H,filterInputChange:$,filterIconClassName:"p-dropdown-filter-icon",props:i});return e.createElement(e.Fragment,null,a)}return null},ee=O.getOtherProps(i),ne=n.reduceKeys(ee,r.ARIA_PROPS),te=t("p-tree p-component",i.className,{"p-tree-selectable":i.selectionMode,"p-tree-loading":i.loading,"p-disabled":i.disabled}),re=function(){if(i.loading){var n="p-tree-loading-icon",t=o.getJSXIcon(i.loadingIcon||e.createElement(s,{className:n,spin:!0}),{className:n},{props:i});return e.createElement("div",{className:"p-tree-loading-overlay p-component-overlay"},t)}return null}(),oe=function(){if(i.value){var n=W(),r=t("p-tree-container",i.contentClassName);return e.createElement("ul",f({className:r,role:"tree",style:i.contentStyle},ne),n)}return null}(),le=function(){if(i.showHeader){var t=Z(),r=t;if(i.header)r=n.getJSXElement(i.header,{filterContainerClassName:"p-tree-filter-container",filterIconClassName:"p-tree-filter-icon",filterInput:{className:"p-tree-filter p-inputtext p-component",onKeyDown:H,onChange:$},filterElement:t,element:r,props:i});return e.createElement("div",{className:"p-tree-header"},r)}return null}(),ae=function(){var t=n.getJSXElement(i.footer,i);return e.createElement("div",{className:"p-tree-footer"},t)}();return e.createElement("div",f({id:i.id,ref:x,className:te,style:i.style},ee),re,le,oe,ae)})));F.displayName="Tree";export{F as Tree};
